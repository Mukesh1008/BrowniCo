<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Brownico • Melting Hearts</title>
  <link href="https://fonts.googleapis.com/css?family=Nunito:400,700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary: #8a2557;
      --secondary: #eecec3;
      --accent: #b43c70;
      --text: #551a35;
      --button-bg: #fff176;
      --header-bg: #fff;
      --bg: #fbe4d6;
      --modal-backdrop: rgba(90, 17, 54, 0.14);
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Nunito', sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      background: var(--header-bg);
      text-align: center;
      padding: 2rem 0 1rem 0;
    }
    header img {
      width: 180px;
      max-width: 80vw;
      margin: 0 auto 0.5rem auto;
      display: block;
    }
    .spin-brownie-btn {
      position: fixed;
      top: 20px;
      right: 16px;
      width: 60px;
      height: 60px;
      z-index: 1202;
      border-radius: 50%;
      box-shadow: 0 8px 26px #552a1633;
      background: #fbe4d6ee;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2.2px solid #8a2557;
      cursor: pointer;
      transition: box-shadow 0.18s, transform 0.18s;
      animation: sizzle-wobble 3.1s infinite;
    }
    .spin-brownie-btn:active {
      box-shadow: 0 2px 10px #b43c7030;
      transform: scale(0.93);
    }
    @keyframes sizzle-wobble {
      0%,
      100% { transform: scale(1); }
      5% { transform: scale(1.07) rotate(-8deg);}
      11% { transform: scale(0.98) rotate(2deg);}
      16% { transform: scale(1.04) rotate(-7deg);}
    }
    .spin-brownie-btn svg {
      width: 36px;
      height: 36px;
    }
    @media (max-width: 650px) {
      .spin-brownie-btn {
        width: 48px;
        height: 48px;
        right: 7px;
        top: 7px;
      }
      .spin-brownie-btn svg {
        width: 27px;
        height: 27px;
      }
    }
    .modal-backdrop {
      position: fixed;
      z-index: 1100;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: var(--modal-backdrop);
      backdrop-filter: blur(1.4px) brightness(0.97);
      transition: backdrop-filter 0.3s;
    }
    .modal {
      position: fixed;
      z-index: 1204;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      min-width: 340px;
      max-width: 99vw;
      background: #fff;
      border-radius: 1.18rem;
      box-shadow: 0 12px 30px #b43c7014;
      padding: 2rem 1.06rem 2rem 1.06rem;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: popIn 0.27s;
    }
    @keyframes popIn {
      from {
        transform: translate(-50%, -43%) scale(0.96);
        opacity: 0.36;
      }
      to {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
    }
    .modal-close {
      position: absolute;
      top: 0.77rem;
      right: 1.07rem;
      font-size: 2rem;
      font-weight: 900;
      color: var(--accent);
      background: transparent;
      border: none;
      cursor: pointer;
    }
    .modal-close:hover {
      color: var(--primary);
    }
    .spin-title {
      letter-spacing: 0.1em;
      font-weight: 800;
      color: var(--primary);
      font-size: 1.19rem;
      margin-bottom: 1.09rem;
    }
    .spin-box {
      width: 340px;
      height: 340px;
      position: relative;
      margin: 1.23em auto;
    }
    .spin-arrow-right {
      position: absolute;
      top: 50%;
      right: -62px;
      transform: translateY(-50%);
      z-index: 2;
      display: flex;
      align-items: center;
    }
    .spin-arrow-right svg {
      width: 64px;
      height: 50px;
      /* Make arrow larger for big wheel */
    }
    @media (max-width: 500px) {
      .spin-box {
        width: 200px;
        height: 200px;
      }
      .spin-arrow-right {
        right: -32px;
      }
      .spin-arrow-right svg {
        width: 32px;
        height: 26px;
      }
    }
    .wheel-canvas {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #fff;
      box-shadow: 0 2px 11px #b43c7033;
      display: block;
    }
    .spin-action-btn {
      background: var(--primary);
      color: #fff;
      border: none;
      outline: none;
      font-size: 1.09rem;
      font-weight: 700;
      padding: 0.94rem 2.12rem;
      border-radius: 2.1rem;
      cursor: pointer;
      margin-top: 1.02rem;
      transition: background 0.13s;
      letter-spacing: 0.04em;
      display: inline-block;
    }
    .spin-action-btn:disabled {
      opacity: 0.7;
      cursor: initial;
    }
    .spin-action-btn:active,
    .spin-action-btn:hover {
      background: var(--accent);
    }
    .spin-result-msg {
      margin-top: 1.1rem;
      background: var(--accent);
      color: #fff;
      font-size: 1.22rem;
      font-weight: 900;
      padding: 1.09rem 0.7rem;
      border-radius: 0.94rem;
      box-shadow: 0 4px 11px #b43c701b;
    }
    .page-blur {
      filter: blur(1.45px) brightness(0.98);
      pointer-events: none;
      user-select: none;
    }
    .intro,
    .cart-videos-section {
      max-width: 500px;
      margin: 2rem auto 0 auto;
      text-align: center;
    }
    .insta-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff;
      color: var(--primary);
      border: 2px solid var(--primary);
      padding: 0.88rem 1.2rem;
      margin: 2.2rem auto 0rem auto;
      border-radius: 2.1rem;
      font-size: 1.1rem;
      font-weight: 700;
      width: fit-content;
    }
    .insta-btn svg {
      height: 1.2em;
      width: 1.2em;
      fill: currentColor;
    }
    .insta-btn:hover {
      background: var(--primary);
      color: #fff;
    }
    footer {
      text-align: center;
      color: var(--primary);
      padding: 2.1rem 0 1.1rem 0;
      font-size: 1rem;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Brownico Logo" width="180" height="auto" loading="lazy" />
  </header>
  <!-- Sizzling Brownie Icon (Top Right) -->
  <button class="spin-brownie-btn" id="spin-brownie-btn" title="Spin &amp; Win!">
    <svg viewBox="0 0 64 64">
      <rect x="11" y="34" width="42" height="13" rx="4" fill="#774438" stroke="#552a16" stroke-width="2" />
      <path d="M21 35Q23 33, 25 35" stroke="#a77a5b" stroke-width="2" fill="none" />
      <path d="M33 35Q36 32, 38 35" stroke="#a77a5b" stroke-width="2" fill="none" />
      <path d="M45 35Q47 33, 49 35" stroke="#a77a5b" stroke-width="2" fill="none" />
      <ellipse cx="32" cy="28" rx="13" ry="8" fill="#fff8e7" stroke="#dea45a" stroke-width="2" />
      <path d="M20 29Q28 38 44 29" stroke="#845141" stroke-width="3" fill="none" />
    </svg>
  </button>
  <div id="main-content">
    <section class="intro">
      <h1>Brownico — Melting Hearts</h1>
      <p>
        What started as a humble brownie cart, sharing smiles on street corners, became a local favourite. Thanks to your love, Brownico now has its own cozy shop, but our mission is still the same: <b>melting hearts, one brownie at a time</b>.
      </p>
    </section>
    <section class="cart-videos-section">
      <h2>Our Origin Cart Videos</h2>
      <div class="cart-videos-placeholder">Cart journey videos coming soon...</div>
    </section>
    <a href="https://instagram.com/thebrownico" class="insta-btn" target="_blank" rel="noopener">
      <svg viewBox="0 0 448 512">
        <path d="M224,202.66A53.34,53.34,0,1,0,277.34,256,53.38,53.38,0,0,0,224,202.66Zm124.71-41a54,54,0,0,0-30.37-30.37c-21-8.21-71-6.36-94.34-6.36s-73.39-1.85-94.34,6.36a54,54,0,0,0-30.37,30.37c-8.21,21-6.36,71-6.36,94.34s-1.85,73.39,6.36,94.34a54,54,0,0,0,30.37,30.37c21,8.21,71,6.36,94.34,6.36s73.39,1.85,94.34-6.36a54,54,0,0,0,30.37-30.37c8.21-21,6.36-71,6.36-94.34S356.92,182.7,348.71,161.71ZM224,338a82,82,0,1,1,82-82A82,82,0,0,1,224,338Zm85.4-148.61a19.2,19.2,0,1,1,19.2-19.2A19.19,19.19,0,0,1,309.4,189.39Z" />
      </svg>
      @thebrownico
    </a>
    <footer>Made with ❤️ by Brownico</footer>
  </div>
  <!-- Modal -->
  <div id="modal-backdrop" class="modal-backdrop" style="display: none"></div>
  <div id="spin-modal" class="modal" style="display: none">
    <button class="modal-close" id="close-modal-btn" aria-label="Close spin modal">&times;</button>
    <div id="spin-modal-content"></div>
  </div>

  <script>
    // Prizes and their probabilities
    const wheelSectors = [
      { label: "BOGO", color: "#FFE082" },
      { label: "10%", color: "#AD93C6" },
      { label: "20%", color: "#F9B384" },
      { label: "30%", color: "#6C5B7B" },
      { label: "40%", color: "#F67280" },
    ];
    const sectorProbabilities = [0.1, 0.3, 0.3, 0.2, 0.1];
    
    const spinBtn = document.getElementById("spin-brownie-btn");
    const modal = document.getElementById("spin-modal");
    const modalContent = document.getElementById("spin-modal-content");
    const modalBackdrop = document.getElementById("modal-backdrop");
    const mainContent = document.getElementById("main-content");
    const closeBtn = document.getElementById("close-modal-btn");

    let hasSpun = false;

    spinBtn.onclick = showModal;
    closeBtn.onclick = closeModal;
    modalBackdrop.onclick = closeModal;

    function showModal() {
      if (!hasSpun) {
        showWheel();
      } else {
        showResult();
      }
      modal.style.display = "";
      modalBackdrop.style.display = "";
      mainContent.classList.add("page-blur");
    }
    function closeModal() {
      modal.style.display = "none";
      modalBackdrop.style.display = "none";
      mainContent.classList.remove("page-blur");
      modalContent.innerHTML = "";
    }
    // Show Spin Wheel directly (no form)
    function showWheel() {
      modalContent.innerHTML = `
        <div class="spin-title">Spin &amp; Win Sweet Prizes!</div>
        <div class="spin-box">
          <div class="spin-arrow-right">
            <svg viewBox="0 0 64 50">
              <!-- ARROW POINTS LEFT (tip AT LEFT, base at right, pointing inwards) -->
              <polygon points="2,25 54,6 54,44" fill="#b43c70" />
              <polygon points="13,25 45,15 45,35" fill="#fff176" />
            </svg>
          </div>
          <canvas id="wheel-canvas" width="340" height="340" class="wheel-canvas"></canvas>
        </div>
        <button class="spin-action-btn" id="spin-once-btn">SPIN</button>
        <div id="spin-result" class="spin-result-msg" style="display:none;"></div>
      `;
      drawWheel();
      document.getElementById("spin-once-btn").onclick = handleSpin;
    }
    function showResult() {
      modalContent.innerHTML = `
        <div class="spin-title">Spin &amp; Win Sweet Prizes!</div>
        <div class="spin-box">
          <div class="spin-arrow-right">
            <svg viewBox="0 0 64 50">
              <polygon points="2,25 54,6 54,44" fill="#b43c70" />
              <polygon points="13,25 45,15 45,35" fill="#fff176" />
            </svg>
          </div>
          <canvas id="wheel-canvas" width="340" height="340" class="wheel-canvas"></canvas>
        </div>
        <div class="spin-result-msg" id="spin-result"></div>
      `;
      drawWheel(lastWinDeg, lastWinIdx);
      setTimeout(function() {
        document.getElementById("spin-result").style.display = "";
        document.getElementById("spin-result").innerHTML = lastWinMsg;
      }, 120);
    }
    // Draw the wheel slices (now 340x340)
    function drawWheel(currentRotation = 0, highlightIdx = null) {
      const canvas = document.getElementById("wheel-canvas");
      if (!canvas) return;
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, 340, 340);
      const N = wheelSectors.length,
        R = 160,
        cx = 170,
        cy = 170;
      const segAngle = (2 * Math.PI) / N;
      let angleOffset = currentRotation;
      for (let i = 0; i < N; ++i) {
        let start = angleOffset + i * segAngle,
          end = angleOffset + (i + 1) * segAngle;
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.arc(cx, cy, R, start, end);
        ctx.closePath();
        ctx.fillStyle = highlightIdx === i ? "#FFFDEB" : wheelSectors[i].color;
        ctx.fill();
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = 5;
        ctx.stroke();

        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(start + segAngle / 2);
        ctx.font = "bold 1.27rem Nunito";
        ctx.fillStyle = "#551a35";
        ctx.textAlign = "center";
        ctx.fillText(wheelSectors[i].label, 98, 0);
        ctx.restore();
      }
      ctx.beginPath();
      ctx.arc(cx, cy, 48, 0, 2 * Math.PI);
      ctx.fillStyle = "#fff";
      ctx.fill();
      ctx.beginPath();
      ctx.arc(cx, cy, 22, 0, 2 * Math.PI);
      ctx.fillStyle = "#b43c70";
      ctx.fill();
    }
    // Easing function for spin
    function strongEaseOut(t) {
      return 1 - Math.pow(1 - t, 5);
    }
    // Random prize weighted selection
    function weightedIndex(weights) {
      const r = Math.random();
      let sum = 0;
      for (let i = 0; i < weights.length; i++) {
        sum += weights[i];
        if (r < sum) return i;
      }
      return weights.length - 1;
    }
    let lastWinDeg = 0;
    let lastWinIdx = 0;
    let lastWinMsg = "";
    function handleSpin() {
      if (hasSpun) return;
      const btn = document.getElementById("spin-once-btn");
      btn.disabled = true;
      btn.innerText = "Spinning...";
      const N = wheelSectors.length,
        segAngle = 360 / N;
      const winIdx = weightedIndex(sectorProbabilities);
      lastWinIdx = winIdx;
      const winDeg = (360 - winIdx * segAngle - segAngle / 2) % 360;
      lastWinDeg = (winDeg * Math.PI) / 180;
      lastWinMsg = `🎉 <b>Congrats!</b><br>You won ${wheelSectors[winIdx].label}!`;
      // 7 full rotations + winner slice
      const totalRot = 7 * 360 + winDeg;
      const totalDuration = 5000; // 5 seconds
      const frameRate = 60;
      const totalFrames = Math.round((totalDuration / 1000) * frameRate);
      let frame = 0;
      function animate() {
        const t = frame / totalFrames;
        const easedProgress = strongEaseOut(t);
        const currentDegree = easedProgress * totalRot;
        drawWheel(((currentDegree * Math.PI) / 180) % (2 * Math.PI));
        if (frame < totalFrames) {
          frame++;
          requestAnimationFrame(animate);
        } else {
          drawWheel(((winDeg * Math.PI) / 180) % (2 * Math.PI), winIdx);
          setTimeout(() => {
            btn.style.display = "none";
            const resultDiv = document.getElementById("spin-result");
            resultDiv.style.display = "";
            resultDiv.innerHTML = lastWinMsg;
            hasSpun = true;
          }, 350);
        }
      }
      animate();
    }
  </script>
</body>
</html>
